# é£æ§è§„åˆ™é…ç½®æ–‡ä»¶
# å¯ä»¥è¦†ç›–ç¯å¢ƒå˜é‡ä¸­çš„é»˜è®¤é…ç½®

rules:
  # çªå‘é¢‘ç‡æ£€æµ‹
  burst:
    enabled: true
    window_sec: 60
    limit_per_token: 120
    description: "æ£€æµ‹Tokenåœ¨çŸ­æ—¶é—´å†…çš„å¼‚å¸¸é«˜é¢‘è¯·æ±‚"
  
  # å…±äº«Tokenæ£€æµ‹
  multi_user_token:
    enabled: true
    users_threshold: 2
    description: "æ£€æµ‹è¢«å¤šä¸ªç”¨æˆ·å…±äº«ä½¿ç”¨çš„Token"
  
  # å¼‚å¸¸IPæ£€æµ‹
  ip_many_users:
    enabled: true
    users_threshold: 5
    description: "æ£€æµ‹å•ä¸ªIPä¸‹çš„å¤šè´¦å·å¼‚å¸¸è¡Œä¸º"
  
  # è¶…å¤§è¯·æ±‚æ£€æµ‹
  big_request:
    enabled: true
    sigma: 3
    description: "åŸºäº3ÏƒåŸåˆ™æ£€æµ‹å¼‚å¸¸å¤§çš„Tokenæ¶ˆè€—"

# ç™½åå•é…ç½®
whitelist:
  # IPç™½åå•ï¼ˆå†…ç½‘IPç­‰ï¼‰
  ips:
    - "127.0.0.1"
    - "10.0.0.0/8"
    - "172.16.0.0/12"
    - "192.168.0.0/16"
  
  # ç”¨æˆ·ç™½åå•ï¼ˆç³»ç»Ÿè´¦å·ç­‰ï¼‰
  users:
    - "system"
    - "admin"
  
  # Tokenç™½åå•ï¼ˆå†…éƒ¨Tokenç­‰ï¼‰
  tokens: []

# å‘Šè­¦é…ç½®
alerts:
  # å‘Šè­¦å†·å´æ—¶é—´ï¼ˆç§’ï¼‰
  cooldown_seconds: 300
  
  # æ‰¹é‡å‘Šè­¦é˜ˆå€¼
  batch_threshold: 10
  
  # å‘Šè­¦æ¨¡æ¿
  templates:
    burst: "ğŸš¨ çªå‘é¢‘ç‡å‘Šè­¦\nToken: {token_name}\næ—¶é—´çª—å£: {window_sec}ç§’\nè¯·æ±‚æ¬¡æ•°: {request_count}\né˜ˆå€¼: {threshold}"
    multi_user_token: "ğŸš¨ å…±äº«Tokenå‘Šè­¦\nToken: {token_name}\nç”¨æˆ·æ•°: {user_count}\nç”¨æˆ·åˆ—è¡¨: {users}"
    ip_many_users: "ğŸš¨ å¼‚å¸¸IPå‘Šè­¦\nIP: {ip}\nç”¨æˆ·æ•°: {user_count}\nç”¨æˆ·åˆ—è¡¨: {users}"
    big_request: "ğŸš¨ è¶…å¤§è¯·æ±‚å‘Šè­¦\nToken: {token_name}\nè¯·æ±‚å¤§å°: {token_count}\nå‡å€¼: {mean}\næ ‡å‡†å·®: {std}"
